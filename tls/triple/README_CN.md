# Dubbo-go Triple mTLS 加密通信

本文档介绍如何通过Dubbo-go的Triple协议实现mTLS（mutual Transport Layer Security）加密通信。

证书文件是使用grpc-go提供的脚本, 在x509目录中，运行`create.sh`即可创建。

## 1. 背景

在分布式系统中，安全加密通信是保护数据免受未经授权访问的关键手段。mTLS通过双向认证进一步提高了安全性，因为它要求客户端和服务器都出示并验证彼此的证书。

## 2. 使用自定义Codec

在本示例中，我们使用msgpack作为自定义序列化/反序列化Codec。虽然Triple协议默认支持protojson，但考虑到某些场景下msgpack可能提供更好的性能，我们选择了msgpack。

### 2.1 为什么不直接使用JSON?

- **性能考虑**: 在某些高性能场景下，msgpack比JSON具有更高的序列化和反序列化速度。
- **协议灵活性**: msgpack有助于支持灵活的协议设计，数据传输时占用更少的带宽。

### 2.2 TODO: 支持JSON Codec

尽管当前使用了msgpack，我们计划在未来版本中为Triple协议添加对JSON Codec的支持。这样用户可以根据需求选择最合适的序列化格式。

## 3. 证书文件路径问题

### 3.1 集成测试的限制

目前，启动集成测试的脚本无法处理相对路径的证书文件，这限制了自动化测试的实现和执行。

### 3.2 未来改进方向

我们计划：
- **更新脚本**: 支持相对路径解析以实现更灵活的文件路径配置。
- **增加文档**: 提供详细的证书生成与路径配置指南。
- **自动化测试**: 增加对mTLS场景的更多集成测试用例，提高安全性及稳定性。
